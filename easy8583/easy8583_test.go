package easy8583

import (
	"encoding/hex"
	"fmt"
	"testing"
)

// go test  ./easy8583.go ./easy8583_test.go
func TestCalcMac16Byte(t *testing.T) {

	//data := "0200702406c020c09a3119622202140201783446300000000000000000010000642601071000010012376222021402017834463d365b25fc5ff152ea20303931303135313533303833353031393339393030383031353656f2d3fe291fcb16261000000000000001399f2701809f101307010103a00000010a010000000000331503b19f370479e926799f3602015c950500000000009a032009299c01009f02060000000000015f2a02015682027c009f1a0201569f03060000000000009f3303e0e9c89f3501229f1e0830303030303030318408a0000003330101019f090200209f4104000000019f2608cc60cf2792f03e790061413230353630313030323034303230323030303030303330344e364e4c3030303031323735303330303638333434363330353030383332303230352020001422000001000601"
	//014a6006010000613200320205
	data :="0200702406C020C09A3116622576863406578100000000000000000100010122110710000100123262257686340657AC94E77942A950E6953039313031353135333038333530313933393930303830313536EE943A959F722991261000000000000001399F2701809F101307010103A00000010A010000000000C6CC45849F37047100B0309F3602003A950500000000009A032010129C01009F02060000000000015F2A02015682027C009F1A0201569F03060000000000009F3303E0E9C89F3501229F1E0830303030303030318408A0000003330101029F090200209F4104000000019F26089EC485B3013609130061413230353630313030323034303230323030303030303330344E364E4C3030303031323735303330303630363537383130353030383332303230352020001422000001000601"
	//data mac：3346414137343534
	//calc mac：3346414137343534
	bdata ,_:= hex.DecodeString(data)//[]byte(data)

	mac, err := CalcMac16Byte(bdata, len(bdata), hexStringToBytes("33333333333333333333333333333333"))
	if nil != err {
		t.Errorf("err:" + err.Error())
		fmt.Println()
	} else {
		t.Fatalf(bytesToHexString(mac))
	}

}

func TestCalcXor(t *testing.T) {
	data:=[]byte("9a31196222021402")
	dataXor1([]byte("0200702406c020c0"), data, 16)
	t.Fatalf(hex.EncodeToString(data))

}
